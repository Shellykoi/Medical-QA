# 医疗知识图谱问答系统需求分析报告

## 1. 需求获取与分析 (5分)

### 1.1 三类核心用户识别

#### 1.1.1 患者/家属用户
**典型问答场景：**
1. **症状咨询**："我最近总是头痛，这是什么原因？"
2. **疾病了解**："高血压有哪些症状和治疗方法？"
3. **饮食建议**："糖尿病患者应该吃什么食物？"

**需求痛点：**
- 担心答案可信度和准确性
- 需要简单易懂的医学解释
- 希望获得权威的医学建议

#### 1.1.2 医生用户
**典型问答场景：**
1. **疾病诊断辅助**："根据这些症状，可能的疾病有哪些？"
2. **治疗方案查询**："这种疾病的标准治疗方案是什么？"
3. **药物相互作用**："这两种药物可以同时使用吗？"

**需求痛点：**
- 需要文献溯源和证据支持
- 要求答案的医学准确性
- 需要快速获取专业信息

#### 1.1.3 系统管理员
**典型问答场景：**
1. **知识图谱维护**："如何更新疾病信息？"
2. **数据质量监控**："系统回答的准确性如何？"
3. **用户反馈处理**："如何处理用户的问题反馈？"

**需求痛点：**
- 需要数据更新和维护工具
- 要求系统稳定性和性能
- 需要用户行为分析

### 1.2 用户需求整理

| 用户类型 | 核心需求 | 优先级 | 实现难度 |
|---------|---------|--------|----------|
| 患者/家属 | 准确、易懂的医学问答 | 高 | 中 |
| 医生 | 专业、权威的医学信息 | 高 | 高 |
| 管理员 | 系统维护和监控 | 中 | 低 |

## 2. 功能需求规格说明 (15分)

### 2.1 核心功能需求

#### FR1: 实体识别与匹配
- **描述**：系统应能识别用户输入问题中的医学实体（如疾病、症状、药物）
- **验证标准**：与知识图谱中的实体匹配准确率≥90%
- **测试集**：100条医学问答
- **实现方式**：基于Aho-Corasick算法的实体识别

#### FR2: 问题分类
- **描述**：系统应能准确分类用户问题类型
- **分类类型**：疾病查询、症状分析、治疗建议、饮食指导
- **准确率要求**：≥85%
- **实现方式**：基于规则和机器学习的分类器

#### FR3: 知识图谱查询
- **描述**：系统应能基于知识图谱生成准确的Cypher查询
- **查询类型**：疾病-症状、疾病-治疗、疾病-并发症等关系查询
- **响应时间**：≤2秒
- **实现方式**：基于模板的查询生成

#### FR4: 答案生成
- **描述**：系统应能生成结构化的医学答案
- **答案格式**：包含疾病描述、症状、治疗、预防等信息
- **可读性**：答案应易于理解，避免过于专业的术语
- **实现方式**：基于模板的答案生成

### 2.2 用例图

```
医疗知识图谱问答系统用例图

患者/家属 --|> 提问
患者/家属 --|> 查看答案
患者/家属 --|> 反馈答案质量

医生 --|> 专业查询
医生 --|> 诊断辅助
医生 --|> 治疗方案查询

管理员 --|> 更新知识图谱
管理员 --|> 监控系统性能
管理员 --|> 管理用户反馈

系统 --|> 实体识别
系统 --|> 问题分类
系统 --|> 知识图谱查询
系统 --|> 答案生成
```

### 2.3 非功能需求

#### NFR1: 医学安全性
- **描述**：答案需标注知识图谱关系路径
- **要求**：路径深度≤3跳，确保医学可追溯性
- **实现**：在答案中显示推理路径，如"高血压-推荐药品-阿司匹林"

#### NFR2: 性能要求
- **描述**：问答响应时间≤2秒
- **并发要求**：支持100用户并发
- **扩展性**：支持横向扩展至1万QPS
- **实现**：使用缓存、负载均衡、数据库优化

#### NFR3: 数据质量
- **描述**：知识图谱数据准确性≥95%
- **更新频率**：医学数据每月更新
- **验证机制**：多源数据交叉验证
- **实现**：定期数据清洗、专家审核

#### NFR4: 用户体验
- **描述**：界面友好，操作简单
- **响应式设计**：支持PC、手机、平板
- **多语言支持**：中文、英文
- **实现**：现代化Web界面，移动端适配

## 3. 垂直原型实现

### 3.1 核心功能实现

#### 3.1.1 实体识别模块
```python
class EntityRecognizer:
    def __init__(self):
        self.disease_dict = self.load_disease_dict()
        self.symptom_dict = self.load_symptom_dict()
        self.drug_dict = self.load_drug_dict()
    
    def recognize_entities(self, text):
        # 使用Aho-Corasick算法识别实体
        pass
```

#### 3.1.2 问题分类模块
```python
class QuestionClassifier:
    def __init__(self):
        self.classifier = self.load_classifier()
    
    def classify_question(self, question):
        # 分类问题类型
        pass
```

#### 3.1.3 知识图谱查询模块
```python
class KnowledgeGraphQuery:
    def __init__(self):
        self.graph = Graph("bolt://localhost:7687")
    
    def query_disease_info(self, disease_name):
        # 查询疾病信息
        pass
```

#### 3.1.4 答案生成模块
```python
class AnswerGenerator:
    def __init__(self):
        self.templates = self.load_templates()
    
    def generate_answer(self, query_result):
        # 生成结构化答案
        pass
```

### 3.2 系统架构

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   用户界面      │    │   问答引擎      │    │   知识图谱      │
│                │    │                │    │                │
│  Web界面       │◄──►│  实体识别       │◄──►│   Neo4j数据库   │
│  API接口       │    │  问题分类       │    │                │
│  移动端        │    │  查询生成       │    │                │
└─────────────────┘    │  答案生成       │    └─────────────────┘
                       └─────────────────┘
```

### 3.3 数据流程

1. **用户输入** → 问题预处理
2. **实体识别** → 提取医学实体
3. **问题分类** → 确定问题类型
4. **查询生成** → 生成Cypher查询
5. **知识图谱查询** → 获取相关信息
6. **答案生成** → 生成结构化答案
7. **结果返回** → 返回给用户

## 4. 实现计划

### 4.1 第一阶段：基础功能
- [x] 知识图谱构建
- [x] 基础问答功能
- [x] Web界面开发

### 4.2 第二阶段：功能完善
- [ ] 实体识别优化
- [ ] 问题分类改进
- [ ] 答案质量提升

### 4.3 第三阶段：性能优化
- [ ] 响应时间优化
- [ ] 并发性能提升
- [ ] 系统监控完善

## 5. 验收标准

### 5.1 功能验收
- 实体识别准确率≥90%
- 问题分类准确率≥85%
- 答案生成质量评分≥4.0/5.0

### 5.2 性能验收
- 响应时间≤2秒
- 支持100用户并发
- 系统可用性≥99%

### 5.3 安全验收
- 数据加密传输
- 用户隐私保护
- 医学信息准确性验证
